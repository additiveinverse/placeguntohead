
extends layout
//- this logic should be moved to a view at some point

block append vars
	- bodyclass = 'archive'

block content
	- var archives = _.chain( env.helpers.getArticles(contents) ).groupBy( function(item) {
	-	 return item.date.getFullYear()
	- }).value()

	h1(class=bodyclass + '-ttl ttl') Archive
	ul(class=bodyclass + '-lst lst ' + bodyclass + '-lst-level1')
		- var yearsK = _.chain(archives).keys().reverse().value()
		- for(var year in yearsK)
			- var archiveYear = yearsK[ year ]
			- months = archives[ archiveYear ]
			- var monthsK = _.chain(months).keys().value()

			li(class=bodyclass + '-itm itm ' + bodyclass + '-itm-level1')
				h2(class=bodyclass + '-ttl ttl ' + bodyclass + '-ttl-level2')= archiveYear
				ul(class=bodyclass + '-lst lst ' + bodyclass + '-lst-level2')
					- for( month in monthsK ) {
						- var m = monthsK[ month ]
						each item in months[ m ]
							li(class=bodyclass + '-itm itm ' + bodyclass + '-itm-level2')
								a(class=bodyclass + "-lnk lnk", href=item.url)=item.title
					- }
					
block prepend navtop
	div.nav
		if prevPage
			a(href=prevPage.url) « Newer
		else
			a(href='/archive.html') « Archives
		if nextPage
			a(href=nextPage.url) Next page »

		a(href=contents.index.url) « Full blog